let __ulex_table_1__c3042a0f3619e1a9624dd28443880f6c =
  "\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\000\000\000\000\000\000\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002"
let __ulex_table_9__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\000\000\000\000\000\000\000\001\001\001\001\001\001\001\
    \001\001\001\000\000\000\000\000\000\000\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\000\000\000\000\001\000\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001"
let __ulex_table_17__c3042a0f3619e1a9624dd28443880f6c =
  "\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\000\000\000\000\002\000\
    \003\003\003\003\003\003\003\003\003\003\003\003\003\003\003\003\
    \003\003\003\003\003\003\003\003\003\003"
let __ulex_table_19__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\000\000\000\000\000\000\000\001\001\001\001\001\001\001\
    \001\001\001\000\000\000\000\000\000\000\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\000\000\000\000\001\002\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001"
let __ulex_table_4__c3042a0f3619e1a9624dd28443880f6c =
  "\001\001\001\001\001\001\001\001\001\001\000\000\000\000\000\000\
    \000\000\000\000\000\002\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\002"
let __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c = "\001"
let __ulex_table_14__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\002\002\002\002\002\002\002\002\002\002\000\000\000\000\
    \000\000\000\000\000\000\000\003\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\003"
let __ulex_table_10__c3042a0f3619e1a9624dd28443880f6c =
  "\001\002\002\002\002\002\002\002\002\002\002\003"
let __ulex_table_7__c3042a0f3619e1a9624dd28443880f6c =
  "\001\001\001\001\001\001\001\001\001\001"
let __ulex_table_21__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\001\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\002"
let __ulex_table_5__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\001\001\001\001\000\000\000\001\001\000\002\001\001\000\
    \000\000\000\000\000\000\000\000\000\001\000\001\001\001\001\001\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001"
let __ulex_table_8__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\001\001\001\001\000\000\000\001\001\000\001\001\001\000\
    \000\000\000\000\000\000\000\000\000\001\000\001\001\001\001\001\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001\000\000\
    \000\000\000\000\002\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001"
let __ulex_table_11__c3042a0f3619e1a9624dd28443880f6c =
  "\001\001\001\001\001\001\001\001\001\001\002\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\003\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \004\004\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\005\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\006"
let __ulex_table_12__c3042a0f3619e1a9624dd28443880f6c =
  "\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\002\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \003\003\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\004\001\001\001\
    \001\001\001\001\001\001\001\001\001\001\001\001\001\001\005"
let __ulex_table_13__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\001\001\001\001\000\000\000\001\001\000\001\001\001\000\
    \000\000\000\000\000\000\000\000\000\001\000\001\001\001\001\001\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001"
let __ulex_table_15__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\000\002\002\002\002\002\002\002\002\002\002"
let __ulex_table_23__c3042a0f3619e1a9624dd28443880f6c =
  "\001\002\002\002\002\002\002\002\002\002\002\003\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\004\002\002\002\002\
    \005"
let __ulex_table_16__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\001"
let __ulex_table_18__c3042a0f3619e1a9624dd28443880f6c =
  "\001\002\002\002\002\002\002\002\002\002\002\003\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\004"
let __ulex_table_20__c3042a0f3619e1a9624dd28443880f6c =
  "\001\002\002\002\002\002\002\002\002\002\002\003\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\004\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\005"
let __ulex_table_22__c3042a0f3619e1a9624dd28443880f6c =
  "\001\002\002\002\002\002\002\002\002\002\002\003\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\004\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\005"
let __ulex_table_2__c3042a0f3619e1a9624dd28443880f6c =
  "\001\002\002\002\002\002\002\002\002\002\003\004\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\003\005\006\005\005\005\005\007\008\009\005\005\010\011\005\
    \012\013\013\013\013\013\013\013\013\013\013\005\014\005\005\005\
    \005\005\015\015\015\015\015\015\015\015\015\015\015\015\015\015\
    \015\015\015\015\015\015\015\015\015\015\015\015\016\017\018\005\
    \019\020\021\021\021\021\021\021\021\021\021\021\021\021\021\021\
    \021\021\021\021\021\021\021\021\021\021\021\021\022\005\023\005\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\024\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\025\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\026\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\002\
    \002\002\002\002\002\002\002\002\002\002\002\002\027"
let __ulex_table_3__c3042a0f3619e1a9624dd28443880f6c =
  "\001\000\001\001\001\001\000\000\000\002\001\000\001\001\001\000\
    \000\000\000\000\000\000\000\000\000\001\000\001\001\001\001\001\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\001\000\001"
let __ulex_partition_20__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 64
  then (-1)
  else
    if c <= 122
    then
      (Char.code __ulex_table_1__c3042a0f3619e1a9624dd28443880f6c.[c - 65]) - 1
    else (-1)
let __ulex_partition_0__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 955
  then
    (Char.code __ulex_table_2__c3042a0f3619e1a9624dd28443880f6c.[c - (-1)]) - 1
  else
    if c <= 10626
    then
      if c <= 8969
      then
        if c <= 8728
        then
          if c <= 8593
          then if c <= 8591 then 1 else 27
          else if c <= 8594 then 28 else 27
        else
          if c <= 8967
          then if c <= 8729 then 29 else 27
          else if c <= 8968 then 30 else 31
      else
        if c <= 10215
        then
          if c <= 8971
          then if c <= 8970 then 32 else 33
          else if c <= 9215 then 27 else 1
        else
          if c <= 10217
          then if c <= 10216 then 34 else 35
          else if c <= 10625 then 1 else 36
    else
      if c <= 11007
      then
        if c <= 11002
        then if c <= 10751 then 1 else 27
        else if c <= 11003 then 37 else 27
      else 1
let __ulex_partition_5__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 32
  then (-1)
  else
    if c <= 126
    then
      (Char.code __ulex_table_3__c3042a0f3619e1a9624dd28443880f6c.[c - 33]) - 1
    else (-1)
let __ulex_partition_8__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 47
  then (-1)
  else
    if c <= 101
    then
      (Char.code __ulex_table_4__c3042a0f3619e1a9624dd28443880f6c.[c - 48]) - 1
    else (-1)
let __ulex_partition_4__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 32
  then (-1)
  else
    if c <= 126
    then
      (Char.code __ulex_table_5__c3042a0f3619e1a9624dd28443880f6c.[c - 33]) - 1
    else (-1)
let __ulex_partition_26__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 104
  then (-1)
  else
    if c <= 105
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 105]) -
        1
    else (-1)
let __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 47
  then (-1)
  else
    if c <= 57
    then
      (Char.code __ulex_table_7__c3042a0f3619e1a9624dd28443880f6c.[c - 48]) - 1
    else (-1)
let __ulex_partition_12__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 32
  then (-1)
  else
    if c <= 126
    then
      (Char.code __ulex_table_8__c3042a0f3619e1a9624dd28443880f6c.[c - 33]) - 1
    else (-1)
let __ulex_partition_14__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 99
  then (-1)
  else
    if c <= 100
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 100]) -
        1
    else (-1)
let __ulex_partition_17__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 107
  then (-1)
  else
    if c <= 108
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 108]) -
        1
    else (-1)
let __ulex_partition_23__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 97
  then (-1)
  else
    if c <= 98
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 98]) - 1
    else (-1)
let __ulex_partition_11__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 38
  then (-1)
  else
    if c <= 122
    then
      (Char.code __ulex_table_9__c3042a0f3619e1a9624dd28443880f6c.[c - 39]) - 1
    else (-1)
let __ulex_partition_16__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 108
  then (-1)
  else
    if c <= 109
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 109]) -
        1
    else (-1)
let __ulex_partition_15__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 122
  then (-1)
  else
    if c <= 123
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 123]) -
        1
    else (-1)
let __ulex_partition_13__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 109
  then (-1)
  else
    if c <= 110
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 110]) -
        1
    else (-1)
let __ulex_partition_35__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 10
  then
    (Char.code __ulex_table_10__c3042a0f3619e1a9624dd28443880f6c.[c - (-1)]) -
      1
  else 1
let __ulex_partition_28__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= (-1)
  then (-1)
  else
    if c <= 110
    then (Char.code __ulex_table_11__c3042a0f3619e1a9624dd28443880f6c.[c]) - 1
    else 0
let __ulex_partition_31__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= (-1)
  then (-1)
  else
    if c <= 110
    then (Char.code __ulex_table_12__c3042a0f3619e1a9624dd28443880f6c.[c]) - 1
    else 0
let __ulex_partition_3__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 32
  then (-1)
  else
    if c <= 126
    then
      (Char.code __ulex_table_13__c3042a0f3619e1a9624dd28443880f6c.[c - 33]) -
        1
    else (-1)
let __ulex_partition_1__c3042a0f3619e1a9624dd28443880f6c c = (-1)
let __ulex_partition_6__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 45
  then (-1)
  else
    if c <= 101
    then
      (Char.code __ulex_table_14__c3042a0f3619e1a9624dd28443880f6c.[c - 46]) -
        1
    else (-1)
let __ulex_partition_9__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 44
  then (-1)
  else
    if c <= 57
    then
      (Char.code __ulex_table_15__c3042a0f3619e1a9624dd28443880f6c.[c - 45]) -
        1
    else (-1)
let __ulex_partition_2__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 8
  then (-1)
  else
    if c <= 32
    then
      (Char.code __ulex_table_16__c3042a0f3619e1a9624dd28443880f6c.[c - 9]) - 1
    else (-1)
let __ulex_partition_18__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 124
  then (-1)
  else
    if c <= 125
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 125]) -
        1
    else (-1)
let __ulex_partition_25__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 102
  then (-1)
  else
    if c <= 103
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 103]) -
        1
    else (-1)
let __ulex_partition_19__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 64
  then (-1)
  else
    if c <= 122
    then
      (Char.code __ulex_table_17__c3042a0f3619e1a9624dd28443880f6c.[c - 65]) -
        1
    else (-1)
let __ulex_partition_34__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 41
  then (-1)
  else
    if c <= 42
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 42]) - 1
    else (-1)
let __ulex_partition_22__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 92
  then
    (Char.code __ulex_table_18__c3042a0f3619e1a9624dd28443880f6c.[c - (-1)]) -
      1
  else 1
let __ulex_partition_33__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 46
  then (-1)
  else
    if c <= 47
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 47]) - 1
    else (-1)
let __ulex_partition_21__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 38
  then (-1)
  else
    if c <= 122
    then
      (Char.code __ulex_table_19__c3042a0f3619e1a9624dd28443880f6c.[c - 39]) -
        1
    else (-1)
let __ulex_partition_27__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 92
  then
    (Char.code __ulex_table_20__c3042a0f3619e1a9624dd28443880f6c.[c - (-1)]) -
      1
  else 1
let __ulex_partition_29__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 8
  then (-1)
  else
    if c <= 92
    then
      (Char.code __ulex_table_21__c3042a0f3619e1a9624dd28443880f6c.[c - 9]) - 1
    else (-1)
let __ulex_partition_30__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 92
  then
    (Char.code __ulex_table_22__c3042a0f3619e1a9624dd28443880f6c.[c - (-1)]) -
      1
  else 1
let __ulex_partition_32__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 47
  then
    (Char.code __ulex_table_23__c3042a0f3619e1a9624dd28443880f6c.[c - (-1)]) -
      1
  else 1
let __ulex_partition_10__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 58
  then (-1)
  else
    if c <= 59
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 59]) - 1
    else (-1)
let __ulex_partition_24__c3042a0f3619e1a9624dd28443880f6c c =
  if c <= 100
  then (-1)
  else
    if c <= 101
    then
      (Char.code __ulex_table_6__c3042a0f3619e1a9624dd28443880f6c.[c - 101]) -
        1
    else (-1)
(*i $Id: scanner.mul 194 2021-03-14 16:56:31Z sufrin $  i*)
(*      
        \subsubsection*{Position-tracking}
        This section keeps track of the current position in
        source file  by noting the position (in  the lexbuffer)
        of each token as it is read and the position of each
        newline as it is read.
        
        The prompt is printed whenever a newline has been read.
*)
let currentpath = ref ""
let prompt = ref ""
let lineNumber = ref 1
let lineStart = ref 0
let relativePath path = let open Filename
  in
    if path = ""
    then path
    else
      if not @@ (is_implicit path)
      then path
      else concat (dirname !currentpath) path
let mkPos path lnum bol col : Lexing.position =
  { pos_fname = path; pos_lnum = lnum; pos_bol = bol; pos_cnum = col; }
let showprompt () =
  if !prompt <> "" then Format.printf "%n %s@?" !lineNumber !prompt else ()
(*  
        This function tracks the linenumber and the position of the current linestart.
        It MUST be invoked immediately on seeing a \n -- whatever symbol it may
        (or may not) appear in. 
    *)
let newline lexbuf =
  (incr lineNumber; showprompt (); lineStart := Ulexing.lexeme_end lexbuf)
(* Invoked when opening a new file *)
let fileState = ref []
let startFile path newprompt =
  (fileState := ((!currentpath), (!prompt)) :: !fileState;
   currentpath := path;
   lineNumber := 1;
   lineStart := 0;
   prompt := newprompt;
   showprompt ())
(* Invoked when closing a file *)
let endFile lexbuf =
  match !fileState with
  | [] -> ()
  | (path, oldprompt) :: rest ->
      (currentpath := path; prompt := oldprompt; fileState := rest)
let inlatex () = Filename.check_suffix !currentpath "tex"
(* 
        \subsubsection*{Map names to symbols} 

*)
open Parse
open Utf8string
let to_string code = Utf8string.to_utf8string (Uchar.of_int code)
(*****************************  Symbol Table *************************)
let idMap : (string, token) Hashtbl.t = Hashtbl.create 150
let to_string : unicodechar -> utf8string =
  fun u ->
    let b = Buffer.create 4 in (Buffer.add_utf_8_uchar b u; Buffer.contents b)
let to_unicode_string code = to_string (Uchar.of_int code)
let notation mkTok codes =
  let addCode code =
    let str = to_unicode_string code in Hashtbl.add idMap str (mkTok str)
  in List.iter addCode codes
let _ =
  (List.iter (fun (s, t) -> Hashtbl.add idMap s t)
     [ ("let", LET); ("in", IN); ("end", END); ("def", DEF); ("with", WITH);
       ("do", DO); ("where", WHERE); ("and", AND); ("rec", REC); ("if", IF);
       ("then", THEN); ("else", ELSE); ("data", DATA); ("type", TYPE);
       ("import", IMPORT); ("notation", NOTATION) ];
   notation (fun s -> ID s)
     [ 0x2205; (* ∅ *) 0x2211; (* ∑ *) 0x220f; (* ∏ *) 0x2210; (* ∐ *)
       0x2200; (* ∀ *) 0x2203; (* ∃ *) 0x21af ])
(* ↯ *)
(* Syntactic roles of identifier strings are looked up by the scanner using mkXXXX 
   All identifiers that appear are mapped by the idMap to their default or declared role
*)
let ret id sym = (Hashtbl.add idMap id sym; sym)
let mkID id = try Hashtbl.find idMap id with | Not_found -> (ret id) @@ (ID id)
let mkCONID id =
  try Hashtbl.find idMap id with | Not_found -> (ret id) @@ (CONID id)
let mkMath id =
  try Hashtbl.find idMap id with | Not_found -> (ret id) @@ (BINL9 id)
let mkMathCon id =
  try Hashtbl.find idMap id with | Not_found -> (ret id) @@ (CONL9 id)
(*  isId str is used to determine whether an identifier string used in the
    program is (by default) or has been declared to be an ID or a CONID. If not
    then it's an infix operator of some kind.
    
    These functions are used during the printing of expressions and values.
*)
let isId str =
  try
    match Hashtbl.find idMap str with
    | ID _ -> true
    | CONID _ -> true
    | _ -> false
  with | Not_found -> false
let isOp str = not (isId str)
let leftOpSymbol =
  Array.of_list
    [ (fun x -> BINL0 x); (fun x -> BINL1 x); (fun x -> BINL2 x);
      (fun x -> BINL3 x); (fun x -> BINL4 x); (fun x -> BINL5 x);
      (fun x -> BINL6 x); (fun x -> BINL7 x); (fun x -> BINL8 x);
      (fun x -> BINL9 x) ]
let rightOpSymbol =
  Array.of_list
    [ (fun x -> BINR0 x); (fun x -> BINR1 x); (fun x -> BINR2 x);
      (fun x -> BINR3 x); (fun x -> BINR4 x); (fun x -> BINR5 x);
      (fun x -> BINR6 x); (fun x -> BINR7 x); (fun x -> BINR8 x);
      (fun x -> BINR9 x) ]
let leftConSymbol =
  Array.of_list
    [ (fun x -> CONL0 x); (fun x -> CONL1 x); (fun x -> CONL2 x);
      (fun x -> CONL3 x); (fun x -> CONL4 x); (fun x -> CONL5 x);
      (fun x -> CONL6 x); (fun x -> CONL7 x); (fun x -> CONL8 x);
      (fun x -> CONL9 x) ]
let rightConSymbol =
  Array.of_list
    [ (fun x -> CONR0 x); (fun x -> CONR1 x); (fun x -> CONR2 x);
      (fun x -> CONR3 x); (fun x -> CONR4 x); (fun x -> CONR5 x);
      (fun x -> CONR6 x); (fun x -> CONR7 x); (fun x -> CONR8 x);
      (fun x -> CONR9 x) ]
(* Experimental notation declarations *)
let declareNotations declns =
  let declareFixity (associativity, priority, symbols) =
    let priority = int_of_string priority
    in
      if (0 <= priority) && (priority <= 9)
      then
        (let mkTok =
           match associativity with
           | "left" -> leftOpSymbol.(priority)
           | "right" -> rightOpSymbol.(priority)
           | "leftdata" -> leftConSymbol.(priority)
           | "rightdata" -> rightConSymbol.(priority)
           | "id" -> (fun x -> ID x)
           | "constant" -> (fun x -> CONID x)
           | _ ->
               failwith
                 ("fixity misdeclared as: " ^
                    (associativity ^
                       ", but should be one of: left, right, leftdata, rightdata, id, con) ")) in
         let addSymbol str = Hashtbl.add idMap str (mkTok str)
         in List.iter addSymbol symbols)
      else failwith ("priority out of bounds: " ^ (string_of_int priority))
  in List.iter declareFixity declns
let mkOP =
  function
  | ":" -> COLON
  | "@" -> ALL
  | "///" -> INSIDE
  | "=" -> EQ "="
  | "|" -> ALT
  | "->" -> TO
  | "." -> DOT
  | "$" -> AT
  | "::" -> CONS "::"
  | s -> mkMath s
(******************************************************)
(* \subsubsection*{Make strings from string fragments} *)
open String
open Char
let int3 s =
  let d i = (code s.[i]) - (code '0')
  in String.make 1 (chr ((((d 1) * 100) + ((d 2) * 10)) + (d 3)))
let str = ref ""
let addstr s = str := !str ^ s
let mkString s = STRING s
let mkChar s = let open Utf8string
  in if (length s) = 1 then CHAR (to_unicodechar s) else STRING s
(*   \subsubsection*{Character classes} *)
(*      
        \subsubsection*{Tokenizing rules} 

*)
let rec token lexbuf =
  let rec __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_0__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 39
    | 1 -> 40
    | 2 -> __ulex_state_3__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 3 -> 1
    | 4 -> __ulex_state_6__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 5 -> 36
    | 6 -> 37
    | 7 -> 5
    | 8 -> 6
    | 9 -> 7
    | 10 -> __ulex_state_13__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 11 -> __ulex_state_16__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 12 -> __ulex_state_18__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 13 -> __ulex_state_25__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 14 -> __ulex_state_27__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 15 -> 14
    | 16 -> __ulex_state_30__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 17 -> 15
    | 18 -> __ulex_state_39__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 19 -> __ulex_state_42__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 20 -> __ulex_state_47__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 21 -> 8
    | 22 -> 13
    | 23 -> 22
    | 24 -> 24
    | 25 -> 23
    | 26 -> 11
    | 27 -> 29
    | 28 -> 20
    | 29 -> 19
    | 30 -> 25
    | 31 -> 26
    | 32 -> 27
    | 33 -> 28
    | 34 -> 9
    | 35 -> 10
    | 36 -> 21
    | 37 -> 18
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_3__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 0;
     match __ulex_partition_2__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 0;
     match __ulex_partition_2__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_6__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 30;
     match __ulex_partition_3__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 30;
     match __ulex_partition_3__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_13__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 30;
     match __ulex_partition_4__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_14__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_14__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 30;
     match __ulex_partition_4__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_15__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_15__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 2;
     match __ulex_partition_3__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_16__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 30;
     match __ulex_partition_5__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_17__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_17__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 3;
     match __ulex_partition_3__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_18__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 4;
     match __ulex_partition_6__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_19__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_24__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 2 -> __ulex_state_21__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_19__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_20__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_20__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 4;
     match __ulex_partition_8__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_20__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_21__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_21__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_9__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_22__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 1 -> __ulex_state_23__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_22__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_23__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_23__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 4;
     match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_23__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_24__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 4;
     match __ulex_partition_6__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_19__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_24__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 2 -> __ulex_state_21__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_25__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 16;
     match __ulex_partition_10__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> 17
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_27__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 32;
     match __ulex_partition_11__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_28__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_28__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 32;
     match __ulex_partition_11__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_28__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_30__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 12;
     match __ulex_partition_12__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_31__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_31__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_13__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_32__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_32__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_14__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_33__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_33__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_15__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_34__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_34__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_16__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_35__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_35__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_17__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_36__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_36__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_18__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 38
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_39__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 35;
     match __ulex_partition_19__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_28__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_40__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 2 -> __ulex_state_41__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_40__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_19__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_28__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 1 -> __ulex_state_40__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 2 -> __ulex_state_41__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_41__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 31;
     match __ulex_partition_11__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_41__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_42__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 40;
     match __ulex_partition_20__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_43__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> __ulex_state_45__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_43__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_21__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_43__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 1 -> 34
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_45__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_21__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_45__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 1 -> 33
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_47__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 31;
     match __ulex_partition_11__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_41__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  in
    (Ulexing.start lexbuf;
     match __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf with
     | 0 -> token lexbuf
     | 1 -> (newline lexbuf; token lexbuf)
     | 2 -> (linecomment lexbuf; token lexbuf)
     | 3 -> (comment lexbuf; token lexbuf)
     | 4 -> NUM (Ulexing.utf8_lexeme lexbuf)
     | 5 -> BRA
     | 6 -> KET
     | 7 -> COMMA
     | 8 -> CURLYBRA
     | 9 -> FUN
     | 10 -> (* ⟨ *) NUF
     | 11 -> (* ⟩ *) LAM
     | 12 -> (* λ *) LAM
     | 13 -> CURLYKET
     | 14 -> SQBRA
     | 15 -> SQKET
     | 16 -> SEMI
     | 17 -> END
     | 18 -> INSIDE
     | 19 -> (* ⫻ *) DOT
     | 20 -> (* ∙ *) TO
     | 21 -> (* → *) CONS "::"
     | 22 -> ID "not"
     | 23 -> (* ¬ *) mkMath (Ulexing.utf8_lexeme lexbuf)
     | 24 -> (* ÷ *) mkMath (Ulexing.utf8_lexeme lexbuf)
     | 25 -> (* × *)
         LEFT ("ceil", (Ulexing.utf8_lexeme lexbuf),
           (to_unicode_string 0x2309))
     | 26 ->
         RIGHT ("ceil", (to_unicode_string 0x2308),
           (Ulexing.utf8_lexeme lexbuf))
     | 27 ->
         LEFT ("floor", (Ulexing.utf8_lexeme lexbuf),
           (to_unicode_string 0x230B))
     | 28 ->
         RIGHT ("floor", (to_unicode_string 0x230A),
           (Ulexing.utf8_lexeme lexbuf))
     | 29 -> mkMath (Ulexing.utf8_lexeme lexbuf)
     | 30 -> mkOP (Ulexing.utf8_lexeme lexbuf)
     | 31 -> mkID (Ulexing.utf8_lexeme lexbuf)
     | 32 -> mkCONID (Ulexing.utf8_lexeme lexbuf)
     | 33 -> mkMath (Ulexing.utf8_lexeme lexbuf)
     | 34 -> (* `foo` *) mkMathCon (Ulexing.utf8_lexeme lexbuf)
     | 35 -> (* `Foo` *) HOLE
     | 36 -> (str := ""; stringbody lexbuf)
     | 37 -> (str := ""; charbody lexbuf)
     | 38 ->
         if inlatex ()
         then skiplatex lexbuf
         else failwith "\\end{ml} token in non-latex file"
     | 39 -> EOF
     | 40 -> token lexbuf
     | _ -> raise Ulexing.Error)
and skiplatex lexbuf =
  let rec __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_22__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 2
    | 1 -> 3
    | 2 -> 0
    | 3 -> __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 3;
     match __ulex_partition_23__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_5__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_5__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_24__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_6__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_6__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_25__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_26__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_13__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_9__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_9__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_15__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_10__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_10__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_16__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_11__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_11__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_17__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_12__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_12__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_18__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 1
    | _ -> Ulexing.backtrack lexbuf
  in
    (Ulexing.start lexbuf;
     match __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf with
     | 0 -> (newline lexbuf; skiplatex lexbuf)
     | 1 -> token lexbuf
     | 2 -> EOF
     | 3 -> skiplatex lexbuf
     | _ -> raise Ulexing.Error)
and stringbody lexbuf =
  let rec __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_27__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 8
    | 1 -> 9
    | 2 -> 0
    | 3 -> 7
    | 4 -> __ulex_state_5__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_5__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 9;
     match __ulex_partition_28__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> 6
     | 1 -> __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 2 -> 3
     | 3 -> __ulex_state_11__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 4 -> 5
     | 5 -> 4
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_7__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 6;
     match __ulex_partition_29__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 1 -> 1
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_29__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 1 -> 1
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_11__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 6;
     match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_12__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_12__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 2
    | _ -> Ulexing.backtrack lexbuf
  in
    (Ulexing.start lexbuf;
     match __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf with
     | 0 -> failwith "End of line in string"
     | 1 -> (newline lexbuf; stringbody lexbuf)
     | 2 -> (addstr (int3 (Ulexing.utf8_lexeme lexbuf)); stringbody lexbuf)
     | 3 -> (addstr "\""; stringbody lexbuf)
     | 4 -> (addstr "\n"; stringbody lexbuf)
     | 5 -> (addstr "\\"; stringbody lexbuf)
     | 6 -> (addstr (Ulexing.utf8_lexeme lexbuf); stringbody lexbuf)
     | 7 -> mkString !str
     | 8 -> failwith "End of file in string"
     | 9 -> (addstr (Ulexing.utf8_lexeme lexbuf); stringbody lexbuf)
     | _ -> raise Ulexing.Error)
and charbody lexbuf =
  let rec __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_30__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 7
    | 1 -> 8
    | 2 -> 0
    | 3 -> 6
    | 4 -> __ulex_state_5__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_5__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 8;
     match __ulex_partition_31__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> 5
     | 1 -> 2
     | 2 -> __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | 3 -> 4
     | 4 -> 3
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_8__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 5;
     match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> __ulex_state_9__c3042a0f3619e1a9624dd28443880f6c lexbuf
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_9__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_7__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 1
    | _ -> Ulexing.backtrack lexbuf
  in
    (Ulexing.start lexbuf;
     match __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf with
     | 0 -> failwith "End of line in char"
     | 1 -> (addstr (int3 (Ulexing.utf8_lexeme lexbuf)); charbody lexbuf)
     | 2 -> (addstr "\""; charbody lexbuf)
     | 3 -> (addstr "\n"; charbody lexbuf)
     | 4 -> (addstr "\\"; charbody lexbuf)
     | 5 -> (addstr (Ulexing.utf8_lexeme lexbuf); charbody lexbuf)
     | 6 -> mkChar !str
     | 7 -> failwith "End of file in character"
     | 8 -> (addstr (Ulexing.utf8_lexeme lexbuf); charbody lexbuf)
     | _ -> raise Ulexing.Error)
and (*   
        Comments must be properly nested  
*) comment lexbuf =
  let rec __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_32__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 4
    | 1 -> 3
    | 2 -> 1
    | 3 -> __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | 4 -> __ulex_state_6__c3042a0f3619e1a9624dd28443880f6c lexbuf
    | _ -> Ulexing.backtrack lexbuf
  and __ulex_state_4__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 3;
     match __ulex_partition_33__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> 0
     | _ -> Ulexing.backtrack lexbuf)
  and __ulex_state_6__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    (Ulexing.mark lexbuf 3;
     match __ulex_partition_34__c3042a0f3619e1a9624dd28443880f6c
             (Ulexing.next lexbuf)
     with
     | 0 -> 2
     | _ -> Ulexing.backtrack lexbuf)
  in
    (Ulexing.start lexbuf;
     match __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf with
     | 0 -> ()
     | 1 -> (newline lexbuf; comment lexbuf)
     | 2 -> (comment lexbuf; comment lexbuf)
     | 3 -> comment lexbuf
     | 4 -> failwith "End of file inside a comment"
     | _ -> raise Ulexing.Error)
and linecomment lexbuf =
  let rec __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf =
    match __ulex_partition_35__c3042a0f3619e1a9624dd28443880f6c
            (Ulexing.next lexbuf)
    with
    | 0 -> 2
    | 1 -> 1
    | 2 -> 0
    | _ -> Ulexing.backtrack lexbuf
  in
    (Ulexing.start lexbuf;
     match __ulex_state_0__c3042a0f3619e1a9624dd28443880f6c lexbuf with
     | 0 -> (newline lexbuf; ())
     | 1 -> linecomment lexbuf
     | 2 -> failwith "End of file inside a --- comment"
     | _ -> raise Ulexing.Error)
(*
\newpage
*)
let getLocation lexbuf =
  ((!lineNumber), ((Ulexing.lexeme_start lexbuf) - !lineStart), (!currentpath))
(*      
        This function fetches the next token and its start and end positions.
        The sequencing of the declarations of its local variables is delicate
        if it's to report positions accurately.
*)
let fetchToken token lexbuf =
  let tok = token lexbuf in
  let startPos =
    mkPos !currentpath !lineNumber !lineStart (Ulexing.lexeme_start lexbuf) in
  let endPos =
    mkPos !currentpath !lineNumber !lineStart (Ulexing.lexeme_end lexbuf)
  in (tok, startPos, endPos)
(* 
        This function, which is called from the parser,
        yields a lexer to be used for the file whose name is
        current. The TeX tokenizer reads its first symbol in
        skiplatex mode, whereas the non-tex tokenizer just
        reads a picoML symbol.
*)
let getLexer lexbuf path prompt =
  (startFile path prompt;
   Syntax.clearPath ();
   (* re-enable path-suppression in position printing *)
   if inlatex ()
   then
     (let intex = ref true
      in
        fun () ->
          if !intex
          then (intex := false; fetchToken skiplatex lexbuf)
          else fetchToken token lexbuf)
   else (fun () -> fetchToken token lexbuf))

